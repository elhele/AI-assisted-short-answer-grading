3.2 the whole code